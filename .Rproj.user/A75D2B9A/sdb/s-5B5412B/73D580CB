{
    "collab_server" : "",
    "contents" : "---\ntitle: \"Public Health Data - World Bank\"\noutput: html_notebook\n---\n\n\n\n```{r}\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(ggplot2)\nlibrary(ggthemes)\nlibrary(scales)\n```\n\n\n# Get data\n```{r}\ndf.per.capita<- read.csv('data/API_SH.XPD.PUBL_DS2_en_csv_v2.csv',skip = 4,stringsAsFactors = FALSE)\nstr(df.per.capita)\n\n\n```\n```{r}\nmissing.years<- c(1960:1994,2015:2016)\nmissing.years.columns<- paste0(\"X\",missing.years)\nvalid.years<- c(1995:2014)\nvalid.years.columns<- paste0(\"X\",valid.years)\ndf.per.capita<-df.per.capita %>% select(-one_of(missing.years.columns))\n\n## drop the countries with missing data\ndf.per.capita<-df.per.capita %>% filter(!is.na(X1995))\ndf.per.capita <-df.per.capita %>% filter(grepl(\"Low income|Lower middle income|Low & middle income|Middle income|Upper middle income|High income\",Country.Name))\nstr(df.per.capita)\ndf.per.capita <- df.per.capita %>% select(one_of(c(\"Country.Name\",valid.years.columns))) \n\n```\n## Add quartile groups\n```{r}\n# df.per.capita <- df.per.capita %>%    mutate(quartile = ntile(X2014, 4)) %>% arrange((quartile))\n# \n# groupy <-df.per.capita %>% group_by(quartile) %>% summarise_at(valid.years.columns,funs(mean))\n```\n## Tranpose\n```{r}\ngato<-df.per.capita %>% gather(year,expenditure,-Country.Name)\ngato <- gato %>% mutate(year=as.numeric(gsub('X','',year)))\ngato$Country.Name <- as.factor(gato$Country.Name)\ngato$Country.Name <- factor(gato$Country.Name,  levels=c(\"Low income\",\"Lower middle income\",\"Low & middle income\",\"Middle income\", \"Upper middle income\",\"High income\"))\n\n\n```\n\n```{r}\nggplot(data=gato ,aes(x=year,y=expenditure,colour=(Country.Name)))+theme_minimal()+ geom_line(size=1)+labs(colour=\"\")+ theme(axis.title = element_text(), axis.title.x=element_blank(), axis.text.x = element_text(angle = 90, hjust = 1),legend.text=element_text(size=10),plot.caption=element_text(size=8))+ ggtitle(\"Health expenditure, public (% of total health expenditure)\")+ylab(\"%\") + scale_colour_brewer(palette = \"RdPu\")\n\n\n```\n\n",
    "created" : 1496241901658.000,
    "dirty" : true,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "873322519",
    "id" : "73D580CB",
    "lastKnownWriteTime" : 1496343582,
    "last_content_update" : 1496343678857,
    "path" : "~/workspace/world_bank/world_bank_charts1.Rmd",
    "project_path" : null,
    "properties" : {
        "chunk_output_type" : "inline",
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}